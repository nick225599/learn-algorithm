package org.nick.learn.leetcode.p918;

public class P918Solution3 {

    // 直观的解法试试
    // 还是超时了
    public int maxSubarraySumCircular(int[] nums) {
        int n = nums.length;

        Integer[] preArr = new Integer[n];
        Integer[] maxArr = new Integer[n];
        int max = nums[0];
        for (int i = 0; i < (n << 1); i++) {
            int num = nums[i % n];

            // 得为每个计算行，都计算一遍... ? 那时间复杂度还是 O(n^2) 啊。。。。
            for (int j = 0; j < n; j++) {
                if (i < j) {
                    break;
                }
                if (i - j >= n){
                    continue;
                }
                if (preArr[j] == null) {
                    preArr[j] = num;
                } else {
                    preArr[j] = Math.max(num, num + preArr[j]);
                }

                if (maxArr[j] == null) {
                    maxArr[j] = preArr[j];
                } else {
                    maxArr[j] = Math.max(maxArr[j], preArr[j]);
                }
            }

            if(i >= n){
                max = Math.max(max, maxArr[i - n]);
            }


        }
        return max;

        // 没想好怎么做，但隐隐觉得 O(n) 就行


        // -2,          1,                        -3,                            4,                 -1,                     2,                  1,                  -5,                     4
        // M(-2) = -2   M(1, 1 + preM)  = 1       =M(-3, -3 + preM) = -2         =M(4, 4 + -2) = 4  =M(-1, -1 + 4) = 3      =M(2, 2 + 3) = 5    =M(1, 1 + 5) = 6    =M(-5, -5 + 6) = 1      =M(4, 4 + 1) = 5
        // max = 6
        //              1,                        -3,                            4,                 -1,                     2,                  1,                  -5,                     4,                      -2,
        //              M(1) = 1                  =M(-3, -3 + preM) = -2         =M(4, 4 + -2) = 4  =M(-1, -1 + 4) = 3      =M(2, 2 + 3) = 5    =M(1, 1 + 5) = 6    =M(-5, -5 + 6) = 1      =M(4, 4 + 1) = 5        =M(-2, -2 + 5) = 3
        // max = 6
        //                                        -3,                            4,                 -1,                     2,                  1,                  -5,                     4,                      -2,                     1,
        //                                        =M(-3)  = -3                   =M(4, 4 + -3) = 4  =M(-1, -1 + 4) = 3      =M(2, 2 + 3) = 5    =M(1, 1 + 5) = 6    =M(-5, -5 + 6) = 1      =M(4, 4 + 1) = 5        =M(-2, -2 + 5) = 3      =M(1, 1 + 3) = 4
        // max = 6
        //                                                                       4,                 -1,                     2,                  1,                  -5,                     4,                      -2,                     1,                  -3,
        //                                                                       =M(4)              =M(-1, -1 + 4) = 3      =M(2, 2 + 3) = 5    =M(1, 1 + 5) = 6    =M(-5, -5 + 6) = 1      =M(4, 4 + 1) = 5        =M(-2, -2 + 5) = 3      =M(1, 1 + 3) = 4    =M(-3, -3 + 4) = 1
        // max = 6
        //                                                                                          -1,                     2,                  1,                  -5,                     4,                      -2,                     1,                  -3,                     4,
        //                                                                                          =M(-1) = -1             =M(2, 2 + -1) = 2   =M(1, 1 + 2) = 3     =M(-5, -5 + 3) = -2    =M(4, 4 + -2) = 4       =M(-2, -2 + 4) = 2      =M(1, 1 + 2) = 3    =M(-3, -3 + 3) = 0      =M(4, 4 + 0) = 4
        // max = 4
        //                                                                                                                  2,                  1,                  -5,                     4,                      -2,                     1,                  -3,                     4,                  -1,
        //                                                                                                                  =M(2)               =M(1, 1 + 2) = 3    =M(-5, -5 + 3) = -2     =M(4, 4 + -2) = 4       =M(-2, -2 + 4) = 2      =M(1, 1 + 2) = 3    =M(-3, -3 + 3) = 0      =M(4, 4 + 0) = 4    =M(-1, -1 + 4) = 3
        // max = 4
        //                                                                                                                                      1,                  -5,                     4,                      -2,                     1,                  -3,                     4,                  -1,                     2,
        //                                                                                                                                      =M(1)               =M(-5, -5 + 1) = -4     =M(4, 4 + -4) = 4       =M(-2, -2 + 4) = 2      =M(1, 1 + 2) = 3    =M(-3, -3 + 3) = 0      =M(4, 4 + 0) = 4    =M(-1, -1 + 4) = 3      =M(2, 2 + 3) = 5
        // max = 5
        //                                                                                                                                                          -5,                     4,                      -2,                     1,                  -3,                     4,                  -1,                     2,                  1,
        //                                                                                                                                                          =M(-5) = -5             =M(4, 4 + -5) = 4       =M(-2, -2 + 4) = 2      =M(1, 1 + 2) = 3    =M(-3, -3 + 3) = 0      =M(4, 4 + 0) = 4    =M(-1, -1 + 4) = 3      =M(2, 2 + 3) = 5    =M(1, 1 + 5) = 6
        // max = 6
        //                                                                                                                                                                                  4,                      -2,                     1,                  -3,                     4,                  -1,                     2,                  1,                  -5
        //                                                                                                                                                                                  =M(4) = 4               =M(-2, -2 + 4) = 2      =M(1, 1 + 2) = 3    =M(-3, -3 + 3) = 0      =M(4, 4 + 0) = 4    =M(-1, -1 + 4) = 3      =M(2, 2 + 3) = 5    =M(1, 1 + 5) = 6    =m(-5, -5 + 6) = 1
        // max = 6
    }


}
